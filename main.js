(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",o)}function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",o)}function o(e){"Escape"===e.key&&n(document.querySelector(".popup_opened"))}e.d({},{i8:()=>f,ri:()=>A,Dr:()=>g,Rm:()=>S,eq:()=>C,yH:()=>k,DG:()=>D,bj:()=>d,td:()=>L,KM:()=>q,O9:()=>s,AD:()=>E,jN:()=>_,sj:()=>P,Ph:()=>m,X7:()=>O,Vu:()=>h,E3:()=>U});var r={baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort-22",headers:{authorization:"9f08c228-ad32-46bd-930f-3baca199438b","Content-Type":"application/json"}};function c(e,t){e.textContent=t?"Сохранение...":"Создать"}function u(e,t){e.textContent=t?"Сохранение...":"Сохранить"}function a(e,n,o,c,u){var a=g.querySelector(".element").cloneNode(!0);return function(e,t){"8fe3f2f06793e0df171a762f"!==t&&(e.querySelector(".element__delete").classList.add("element__delete_disabled"),e.querySelector(".element__delete").disabled=!0)}(a,c),a.querySelector(".element__delete").addEventListener("click",(function(e){!function(e){fetch("".concat(r.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:r.headers}).catch((function(e){console.log(e)}))}(u),a.closest(".element").remove()})),a.querySelector(".element__image").src=e,a.querySelector(".element__image").alt=n,a.querySelector(".element__title").textContent=n,function(e,n,o){e.querySelector(".element__overlay").addEventListener("click",(function(){t(_),k.src=n,k.alt=o,C.textContent=o}))}(a,e,n),function(e,t,n){var o=e.length;0!=o&&(t.querySelector(".element__like-count").classList.add("element__like-count_active"),t.querySelector(".element__like-count").textContent=o),e.forEach((function(e){"8fe3f2f06793e0df171a762f"===e._id&&t.querySelector(".element__like").classList.add("element__like_active")})),t.querySelector(".element__like").addEventListener("click",(function(e){0===o&&t.querySelector(".element__like-count").classList.add("element__like-count_active"),e.target.classList.toggle("element__like_active")?(function(e){fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:r.headers}).catch((function(e){console.log(e)}))}(n),o++,t.querySelector(".element__like-count").textContent=o):(function(e){fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:r.headers}).catch((function(e){console.log(e)}))}(n),o--,t.querySelector(".element__like-count").textContent=o),0===o&&t.querySelector(".element__like-count").classList.remove("element__like-count_active")}))}(o,a,u),a}function l(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))}var i=document.querySelector("form[name=form]"),s=document.querySelector("input[name=name]"),d=document.querySelector("input[name=job]"),m=document.querySelector(".profile-popup"),f=document.querySelector(".add-popup"),_=document.querySelector(".picture-popup"),y=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__add-button"),v=document.querySelectorAll(".form__close-button"),S=document.querySelector(".elements"),h=document.querySelector("input[name=name-place]"),q=document.querySelector("input[name=link]"),b=document.querySelector("form[name=formCard]"),g=document.querySelector("#element").content,k=document.querySelector(".figure__image"),C=document.querySelector(".figure__caption"),E=document.querySelector(".profile__heading-name"),L=document.querySelector(".profile__job"),x=document.querySelectorAll(".popup"),j=document.querySelector(".profile__avatar-container"),A=document.querySelector(".profile__avatar"),P=document.querySelector(".popup-update"),U={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_type_error",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},D=Array.from(b.querySelectorAll(U.inputSelector)),O=b.querySelector(U.submitButtonSelector);y.addEventListener("click",(function(){t(m),s.value=E.textContent,d.value=L.textContent})),p.addEventListener("click",(function(){return t(f)})),v.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return n(t)}))})),j.addEventListener("click",(function(){t(P)})),i.addEventListener("submit",(function(e){var t,o;e.preventDefault(),u(e.target.querySelector(".form__submit-button"),!0),(t=s.value,o=d.value,fetch("".concat(r.baseUrl,"/users/me"),{method:"PATCH",headers:r.headers,body:JSON.stringify({name:t,about:o})}).catch((function(e){console.log(e)}))).finally((function(){u(e.target.querySelector(".form__submit-button"),!1),E.textContent=s.value,L.textContent=d.value,n(m)}))})),b.addEventListener("submit",(function(e){var t,o;e.preventDefault(),c(e.target.querySelector(".form__submit-button"),!0),(t=h.value,o=q.value,fetch("".concat(r.baseUrl,"/cards"),{method:"POST",headers:r.headers,body:JSON.stringify({name:t,link:o})}).catch((function(e){console.log(e)}))).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){S.prepend(a(e.link,e.name,e.likes,e.owner._id,e._id))})).catch((function(e){console.log(e)})).finally((function(){c(e.target.querySelector(".form__submit-button"),!1),e.target.reset(),l(D,O,U),n(f)}))})),P.addEventListener("submit",(function(e){var t;e.preventDefault(),u(e.target.querySelector(".form__submit-button"),!0),(t=P.querySelector(".form__input").value,fetch("".concat(r.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:r.headers,body:JSON.stringify({avatar:t})}).catch((function(e){console.log(e)}))).finally((function(){u(e.target.querySelector(".form__submit-button"),!1),A.src=P.querySelector(".form__input").value,e.target.reset(),l(Array.from(e.target.querySelectorAll(".form__input")),e.target.querySelector(".form__submit-button"),U),n(P)}))})),fetch("".concat(r.baseUrl,"/cards"),{headers:r.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)})).then((function(e){for(var t=0;t<e.length;t++)S.append(a(e[t].link,e[t].name,e[t].likes,e[t].owner._id,e[t]._id))})),fetch("".concat(r.baseUrl,"/users/me"),{headers:r.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)})).then((function(e){E.textContent=e.name,L.textContent=e.about,A.src=e.avatar})),x.forEach((function(e){e.addEventListener("mousedown",(function(e){n(e.target)}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);l(n,o,t),n.forEach((function(e){e.addEventListener("input",(function(){(function(e,t){e.validity.patternMismatch?e.setCustomValidity(e.dataset.error):e.value.length?e.setCustomValidity(""):e.setCustomValidity(e.dataset.errorMessage),e.validity.valid?function(e,t){var n=document.querySelector(".".concat(e.id,"-error"));n.classList.remove(t.errorClass),n.textContent="",e.classList.remove(t.inputErrorClass)}(e,t):function(e,t,n){var o=document.querySelector(".".concat(e.id,"-error"));o.classList.add(n.errorClass),o.textContent=t,e.classList.add(n.inputErrorClass)}(e,e.validationMessage,t)})(e,t),l(n,o,t)}))}))}(t,e)}))}(U)})();